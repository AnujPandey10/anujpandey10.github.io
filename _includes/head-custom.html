{%- comment -%}
  Theme init runs *early* (in <head>) to avoid a flash of the wrong theme.
  The full toggle logic is in `/assets/js/theme-toggle.js` (loaded once, deferred).
{%- endcomment -%}

<script>
  (() => {
    try {
      const stored = localStorage.getItem('theme'); // 'light' | 'dark' | null
      const prefersDark =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches;
      const theme =
        stored === 'dark' || stored === 'light'
          ? stored
          : prefersDark
            ? 'dark'
            : 'light';

      document.documentElement.setAttribute('data-theme', theme);
      // Helps native form controls render appropriately.
      document.documentElement.style.colorScheme = theme;
    } catch (_) {
      // If storage is blocked, fall back to default CSS.
    }
  })();
</script>

<link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
<script defer src="{{ '/assets/js/theme-toggle.js' | relative_url }}"></script>

